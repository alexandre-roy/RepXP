{% extends "site_web/base.html" %}

{% block title %}
    <title>RepXP | Créer un badge</title>
{% endblock %}

{% block navigation %}
    <a href="{% url 'badge_list' %}" class="inactive-link">LISTE DE BADGES</a>
    <a href="{% url 'create_badge' %}" class="active-link">CREER UN BADGE</a>
{% endblock %}

{% block main %}

    <div class="container d-flex justify-content-center">
        <form method="post" enctype="multipart/form-data" class="form-group background-form" novalidate>
            {% csrf_token %}
            <div class="mb-3 p-4">
            <div class="mb-3 text-start">
                <label for="{{ form.nom.id_for_label }}" class="form-label m-0 fw-semibold">Nom</label>
                {{ form.nom }}
                {% if form.nom.errors %}
                <div class="invalid-feedback d-block">{{ form.nom.errors.0 }}</div>
                {% endif %}
            </div>

            <div class="mb-3 text-start">
                <label for="{{ form.icone.id_for_label }}" class="form-label m-0 fw-semibold">Icône</label>
                {{ form.icone }}
                {% if form.icone.errors %}
                    <div class="invalid-feedback d-block">{{ form.icone.errors.0 }}</div>
                {% endif %}
            </div>

            <div class="mb-3 text-start">
                <label for="{{ form.categorie.id_for_label }}" class="form-label m-0 fw-semibold">Catégorie</label>
                {{ form.categorie }}
                {% if form.categorie.errors %}
                <div class="invalid-feedback d-block">{{ form.categorie.errors.0 }}</div>
                {% endif %}
            </div>

            <div class="mb-3 text-start">
                <label for="{{ form.condition_type.id_for_label }}" class="form-label m-0 fw-semibold">Type de condition</label>
                {{ form.condition_type }}
                {% if form.condition_type.errors %}
                <div class="invalid-feedback d-block">{{ form.condition_type.errors.0 }}</div>
                {% endif %}
            </div>

            <div class="mb-3 text-start">
                <label for="{{ form.condition_param.id_for_label }}" class="form-label m-0 fw-semibold" id="label-condition-param">
                    Paramètre de la condition
                </label>
                {{ form.condition_param }}
                {% if form.condition_param.errors %}
                <div class="invalid-feedback d-block">{{ form.condition_param.errors.0 }}</div>
                {% endif %}
            </div>

            <div class="mb-3 text-start">
                <label for="{{ form.description.id_for_label }}" class="form-label m-0 fw-semibold">Description</label>
                {{ form.description }}
                {% if form.description.errors %}
                    <div class="invalid-feedback d-block">{{ form.description.errors.0 }}</div>
                {% endif %}
            </div>


            <div class="d-flex justify-content-center mt-3">
                <input type="reset" class="form-control mt-3 style-button-danger w-50" value="RÉINITIALISER">
                <input type="submit" class="form-control mt-3 style-button w-50" value="CRÉER">
            </div>
        </div>
    </form>
    </div>


    <script>
        document.addEventListener("DOMContentLoaded", function() {
            const typeSelect = document.querySelector("#id_condition_type");
            const paramInput = document.querySelector("#id_condition_param");
            const paramLabel = document.getElementById("label-condition-param");
            const helpText = document.getElementById("help-condition-param");

            function updateParamField() {
                if (!typeSelect || !paramInput) return;

                if (typeSelect.value === "DEFI") {
                    paramLabel.textContent = "Défi associé (ID)";
                    paramInput.placeholder = "Ex : 3 (ID du défi)";
                    helpText.textContent = "Indique l'ID du défi qui débloque ce badge.";
                } else if (typeSelect.value === "NB_DEFIS") {
                    paramLabel.textContent = "Nombre de défis requis";
                    paramInput.placeholder = "Ex : 10";
                    helpText.textContent = "Nombre total de défis que l'utilisateur doit compléter.";
                } else {
                    paramLabel.textContent = "Paramètre de la condition";
                    paramInput.placeholder = "";
                    helpText.textContent = "Ex : ID du défi ou nombre de défis à compléter.";
                }
            }

            if (typeSelect) {
                typeSelect.addEventListener("change", updateParamField);
                updateParamField();
            }
        });
    </script>
{% endblock %}